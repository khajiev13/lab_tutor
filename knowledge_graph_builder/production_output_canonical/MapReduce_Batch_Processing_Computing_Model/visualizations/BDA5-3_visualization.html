<style>
.lx-highlight { position: relative; border-radius:3px; padding:1px 2px;}
.lx-highlight .lx-tooltip {
  visibility: hidden;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  background: #333;
  color: #fff;
  text-align: left;
  border-radius: 4px;
  padding: 6px 8px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  max-width: 240px;
  white-space: normal;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}
.lx-highlight:hover .lx-tooltip { visibility: visible; opacity:1; }
.lx-animated-wrapper { max-width: 100%; font-family: Arial, sans-serif; }
.lx-controls {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 8px;
  padding: 12px; margin-bottom: 16px;
}
.lx-button-row {
  display: flex; justify-content: center; gap: 8px; margin-bottom: 12px;
}
.lx-control-btn {
  background: #4285f4; color: white; border: none; border-radius: 4px;
  padding: 8px 16px; cursor: pointer; font-size: 13px; font-weight: 500;
  transition: background-color 0.2s;
}
.lx-control-btn:hover { background: #3367d6; }
.lx-progress-container {
  margin-bottom: 8px;
}
.lx-progress-slider {
  width: 100%; margin: 0; appearance: none; height: 6px;
  background: #ddd; border-radius: 3px; outline: none;
}
.lx-progress-slider::-webkit-slider-thumb {
  appearance: none; width: 18px; height: 18px; background: #4285f4;
  border-radius: 50%; cursor: pointer;
}
.lx-progress-slider::-moz-range-thumb {
  width: 18px; height: 18px; background: #4285f4; border-radius: 50%;
  cursor: pointer; border: none;
}
.lx-status-text {
  text-align: center; font-size: 12px; color: #666; margin-top: 4px;
}
.lx-text-window {
  font-family: monospace; white-space: pre-wrap; border: 1px solid #90caf9;
  padding: 12px; max-height: 260px; overflow-y: auto; margin-bottom: 12px;
  line-height: 1.6;
}
.lx-attributes-panel {
  background: #fafafa; border: 1px solid #90caf9; border-radius: 6px;
  padding: 8px 10px; margin-top: 8px; font-size: 13px;
}
.lx-current-highlight {
  border-bottom: 4px solid #ff4444;
  font-weight: bold;
  animation: lx-pulse 1s ease-in-out;
}
@keyframes lx-pulse {
  0% { text-decoration-color: #ff4444; }
  50% { text-decoration-color: #ff0000; }
  100% { text-decoration-color: #ff4444; }
}
.lx-legend {
  font-size: 12px; margin-bottom: 8px;
  padding-bottom: 8px; border-bottom: 1px solid #e0e0e0;
}
.lx-label {
  display: inline-block;
  padding: 2px 4px;
  border-radius: 3px;
  margin-right: 4px;
  color: #000;
}
.lx-attr-key {
  font-weight: 600;
  color: #1565c0;
  letter-spacing: 0.3px;
}
.lx-attr-value {
  font-weight: 400;
  opacity: 0.85;
  letter-spacing: 0.2px;
}

/* Add optimizations with larger fonts and better readability for GIFs */
.lx-gif-optimized .lx-text-window { font-size: 16px; line-height: 1.8; }
.lx-gif-optimized .lx-attributes-panel { font-size: 15px; }
.lx-gif-optimized .lx-current-highlight { text-decoration-thickness: 4px; }
</style>
    <div class="lx-animated-wrapper lx-gif-optimized">
      <div class="lx-attributes-panel">
        <div class="lx-legend">Highlights Legend: <span class="lx-label" style="background-color:#D2E3FC;">CONCEPT</span> <span class="lx-label" style="background-color:#C8E6C9;">KEYWORDS</span> <span class="lx-label" style="background-color:#FEF0C3;">TOPIC</span></div>
        <div id="attributesContainer"></div>
      </div>
      <div class="lx-text-window" id="textWindow">
        Hello everyone, I am Haiying Che, from  Institute of Data Science and knowledge Engineering
School of Computer Science, in Beijing Institute of Technology , in this session we <span class="lx-highlight lx-current-highlight" data-idx="0" style="background-color:#FEF0C3;">discuss batch processing <span class="lx-highlight" data-idx="1" style="background-color:#D2E3FC;">computing model</span></span>, represented by MapReduce.
The data processing system provides big data computing and processing capabilities and an application development platform.
From the perspective of computing architecture, the data processing system is divided into data algorithm layer, computing model layer, computing platform layer, computing engine layer, etc.
Computing models are the way that different kinds of big data is processed in different scenarios, 
which include batch processing, stream computing, Large-scale concurrent processing (MPP) model for structured data, In-memory Computing model, and Data Flow Graph models.
We first look at the batch processing model represented by MapReduce
Let’s watch a video about “Learn MapReduce with Playing Cards “ to easily understand the mechanism of map reduce process Intuitively
From the video we understand the basic working mechanism of Map Reduce. 
MR tries to parallelize the big computing tasks in distributed environment to improve efficiency.
the storing unit in HDFS is data blocks, Retrieve the data from HDFS data blocks , then organize input data as data split feed into the map tasks.
The output of map task are going through the shuffle  phase through sort , copy and merge operations showed in the diagram.
After shuffle the reorganized middle results become the input of the reduce tasks, and after reduce phase , the final result is calculated.
MapReduce architecture mainly four parts: Client, <span class="lx-highlight" data-idx="2" style="background-color:#D2E3FC;">JobTracker</span>,<span class="lx-highlight" data-idx="3" style="background-color:#D2E3FC;">TaskTracker</span>，Task
) <span class="lx-highlight" data-idx="4" style="background-color:#D2E3FC;">Client
MapReduce program written by the user is submitted to the JobTracker through the client
Users can view job running status through some interfaces provided by Client
)</span> JobTracker
JobTracker is responsible for resource monitoring and job scheduling
JobTracker monitors the health status of all TaskTrackers and Jobs, and if it finds a failure, it will transfer the corresponding tasks to other nodes
JobTracker will track the task execution progress, resource usage, and other information, and inform the <span class="lx-highlight" data-idx="5" style="background-color:#D2E3FC;">task scheduler (TaskScheduler), and the scheduler will select the appropriate task to use these resources when resources become free
)</span> TaskTracker
TaskTracker will periodically report the usage of resources on the node and the progress of the task to the JobTracker through the &quot;heartbeat&quot;, 
and at the same time receive the commands sent by the JobTracker and perform the corresponding operations (such as starting new tasks, killing tasks, etc.)
TaskTracker uses &quot;<span class="lx-highlight" data-idx="6" style="background-color:#D2E3FC;">slot</span>&quot; to divide the amount of resources (CPU, memory, etc.) on this node. A Task has a chance to run after it gets a slot, and the role of the <span class="lx-highlight" data-idx="7" style="background-color:#D2E3FC;">Hadoop scheduler</span> is to allocate idle slots on each TaskTracker to the Task. Slots are divided into Map slot and Reduce slot, which are used by MapTask and Reduce Task respectively.
) Task
Task is divided into Map Task and Reduce Task, which are started by TaskTracker
Task scheduler is responsible for Selecting the appropriate task to use these resources when resources become free
Slot is amount of resources (CPU, memory, etc.)., which include Map slot and Reduce slot.
Hadoop scheduler is to allocate idle slots on each TaskTracker to the Task.
Let’s combine the HDFS and MapReduce together. HDFS and MapReduce  should be built on the same cluster. The master node should be both name node in HDFS and Job tracker in <span class="lx-highlight" data-idx="8" style="background-color:#C8E6C9;">MapReduce,</span> 
and the slave node should be both the datanode in HDFS and tasktracker in MapReduce.
For example we build a one master node and three slave nodes HDFS and MapReduce cluster.
In order to reduce the data transmission overhead, we should try to make the input data of corresponding map task to be as close as possible, it is better on the same machine.
In this session, we learned batch processing model <span class="lx-highlight" data-idx="9" style="background-color:#D2E3FC;">MapReduce</span>.
thank you for your attention, if you have any question, feel free to contact me.
      </div>
      <div class="lx-controls">
        <div class="lx-button-row">
          <button class="lx-control-btn" onclick="playPause()">▶️ Play</button>
          <button class="lx-control-btn" onclick="prevExtraction()">⏮ Previous</button>
          <button class="lx-control-btn" onclick="nextExtraction()">⏭ Next</button>
        </div>
        <div class="lx-progress-container">
          <input type="range" id="progressSlider" class="lx-progress-slider"
                 min="0" max="9" value="0"
                 onchange="jumpToExtraction(this.value)">
        </div>
        <div class="lx-status-text">
          Entity <span id="entityInfo">1/10</span> |
          Pos <span id="posInfo">[176-216]</span>
        </div>
      </div>
    </div>

    <script>
      (function() {
        const extractions = [{"index": 0, "class": "TOPIC", "text": "MapReduce Batch Processing Computing Model", "color": "#FEF0C3", "startPos": 176, "endPos": 216, "beforeText": "ng Che, from  Institute of Data Science and knowledge Engineering\nSchool of Computer Science, in Beijing Institute of Technology , in this session we ", "extractionText": "discuss batch processing computing model", "afterText": ", represented by MapReduce.\nThe data processing system provides big data computing and processing capabilities and an application development platform", "attributesHtml": "<div><strong>class:</strong> TOPIC</div><div><strong>attributes:</strong> {}</div>"}, {"index": 1, "class": "CONCEPT", "text": "Computing Models", "color": "#D2E3FC", "startPos": 201, "endPos": 216, "beforeText": "f Data Science and knowledge Engineering\nSchool of Computer Science, in Beijing Institute of Technology , in this session we discuss batch processing ", "extractionText": "computing model", "afterText": ", represented by MapReduce.\nThe data processing system provides big data computing and processing capabilities and an application development platform", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">The way that different kinds of big data is processed in different scenarios, which include batch processing, stream computing, Large-scale concurrent processing (MPP) model for structured data, In-memory Computing model, and Data Flow Graph models.</span>}</div>"}, {"index": 2, "class": "CONCEPT", "text": "JobTracker", "color": "#D2E3FC", "startPos": 1665, "endPos": 1675, "beforeText": "ults become the input of the reduce tasks, and after reduce phase , the final result is calculated.\nMapReduce architecture mainly four parts: Client, ", "extractionText": "JobTracker", "afterText": ",TaskTracker\uff0cTask\n) Client\nMapReduce program written by the user is submitted to the JobTracker through the client\nUsers can view job running status t", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A component responsible for resource monitoring and job scheduling. It monitors the health of all TaskTrackers and Jobs, tracks task progress and resource usage, and informs the task scheduler.</span>}</div>"}, {"index": 3, "class": "CONCEPT", "text": "TaskTracker", "color": "#D2E3FC", "startPos": 1676, "endPos": 1687, "beforeText": " the input of the reduce tasks, and after reduce phase , the final result is calculated.\nMapReduce architecture mainly four parts: Client, JobTracker,", "extractionText": "TaskTracker", "afterText": "\uff0cTask\n) Client\nMapReduce program written by the user is submitted to the JobTracker through the client\nUsers can view job running status through some ", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A component that periodically reports resource usage and task progress to the JobTracker via a &#x27;heartbeat&#x27; and executes commands from the JobTracker, such as starting or killing tasks.</span>}</div>"}, {"index": 4, "class": "CONCEPT", "text": "Client (MapReduce)", "color": "#D2E3FC", "startPos": 1695, "endPos": 1868, "beforeText": "educe tasks, and after reduce phase , the final result is calculated.\nMapReduce architecture mainly four parts: Client, JobTracker,TaskTracker\uff0cTask\n) ", "extractionText": "Client\nMapReduce program written by the user is submitted to the JobTracker through the client\nUsers can view job running status through some interfaces provided by Client\n)", "afterText": " JobTracker\nJobTracker is responsible for resource monitoring and job scheduling\nJobTracker monitors the health status of all TaskTrackers and Jobs, a", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A component through which a user-written MapReduce program is submitted to the JobTracker. It also provides interfaces for users to view job running status.</span>}</div>"}, {"index": 5, "class": "CONCEPT", "text": "Task (MapReduce)", "color": "#D2E3FC", "startPos": 2205, "endPos": 2339, "beforeText": "nsfer the corresponding tasks to other nodes\nJobTracker will track the task execution progress, resource usage, and other information, and inform the ", "extractionText": "task scheduler (TaskScheduler), and the scheduler will select the appropriate task to use these resources when resources become free\n)", "afterText": " TaskTracker\nTaskTracker will periodically report the usage of resources on the node and the progress of the task to the JobTracker through the &quot;heart", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A unit of work, divided into Map Task and Reduce Task, which is started by a TaskTracker.</span>}</div>"}, {"index": 6, "class": "CONCEPT", "text": "Slot", "color": "#D2E3FC", "startPos": 2671, "endPos": 2675, "beforeText": "eive the commands sent by the JobTracker and perform the corresponding operations (such as starting new tasks, killing tasks, etc.)\nTaskTracker uses &quot;", "extractionText": "slot", "afterText": "&quot; to divide the amount of resources (CPU, memory, etc.) on this node. A Task has a chance to run after it gets a slot, and the role of the Hadoop sche", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">Represents an amount of resources (CPU, memory, etc.) on a node. A Task can run after it gets a slot. Slots are divided into Map slots and Reduce slots for their respective tasks.</span>}</div>"}, {"index": 7, "class": "CONCEPT", "text": "Hadoop Scheduler", "color": "#D2E3FC", "startPos": 2814, "endPos": 2830, "beforeText": " uses &quot;slot&quot; to divide the amount of resources (CPU, memory, etc.) on this node. A Task has a chance to run after it gets a slot, and the role of the ", "extractionText": "Hadoop scheduler", "afterText": " is to allocate idle slots on each TaskTracker to the Task. Slots are divided into Map slot and Reduce slot, which are used by MapTask and Reduce Task", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A component responsible for allocating idle slots on each TaskTracker to a Task.</span>}</div>"}, {"index": 8, "class": "KEYWORDS", "text": "MapReduce, batch processing, HDFS, JobTracker, TaskTracker, shuffle phase, slot, Hadoop scheduler, data split, distributed computing", "color": "#C8E6C9", "startPos": 3535, "endPos": 3545, "beforeText": " and MapReduce together. HDFS and MapReduce  should be built on the same cluster. The master node should be both name node in HDFS and Job tracker in ", "extractionText": "MapReduce,", "afterText": " \nand the slave node should be both the datanode in HDFS and tasktracker in MapReduce.\nFor example we build a one master node and three slave nodes HD", "attributesHtml": "<div><strong>class:</strong> KEYWORDS</div><div><strong>attributes:</strong> {}</div>"}, {"index": 9, "class": "CONCEPT", "text": "MapReduce", "color": "#D2E3FC", "startPos": 3948, "endPos": 3957, "beforeText": "input data of corresponding map task to be as close as possible, it is better on the same machine.\nIn this session, we learned batch processing model ", "extractionText": "MapReduce", "afterText": ".\nthank you for your attention, if you have any question, feel free to contact me.", "attributesHtml": "<div><strong>class:</strong> CONCEPT</div><div><strong>attributes:</strong> {<span class=\"lx-attr-key\">definition</span>: <span class=\"lx-attr-value\">A batch processing model that parallelizes large computing tasks in a distributed environment to improve efficiency. It involves Map tasks, a shuffle phase, and Reduce tasks to process data.</span>}</div>"}];
        let currentIndex = 0;
        let isPlaying = false;
        let animationInterval = null;
        let animationSpeed = 1.0;

        function updateDisplay() {
          const extraction = extractions[currentIndex];
          if (!extraction) return;

          document.getElementById('attributesContainer').innerHTML = extraction.attributesHtml;
          document.getElementById('entityInfo').textContent = (currentIndex + 1) + '/' + extractions.length;
          document.getElementById('posInfo').textContent = '[' + extraction.startPos + '-' + extraction.endPos + ']';
          document.getElementById('progressSlider').value = currentIndex;

          const playBtn = document.querySelector('.lx-control-btn');
          if (playBtn) playBtn.textContent = isPlaying ? '⏸ Pause' : '▶️ Play';

          const prevHighlight = document.querySelector('.lx-text-window .lx-current-highlight');
          if (prevHighlight) prevHighlight.classList.remove('lx-current-highlight');
          const currentSpan = document.querySelector('.lx-text-window span[data-idx="' + currentIndex + '"]');
          if (currentSpan) {
            currentSpan.classList.add('lx-current-highlight');
            currentSpan.scrollIntoView({block: 'center', behavior: 'smooth'});
          }
        }

        function nextExtraction() {
          currentIndex = (currentIndex + 1) % extractions.length;
          updateDisplay();
        }

        function prevExtraction() {
          currentIndex = (currentIndex - 1 + extractions.length) % extractions.length;
          updateDisplay();
        }

        function jumpToExtraction(index) {
          currentIndex = parseInt(index);
          updateDisplay();
        }

        function playPause() {
          if (isPlaying) {
            clearInterval(animationInterval);
            isPlaying = false;
          } else {
            animationInterval = setInterval(nextExtraction, animationSpeed * 1000);
            isPlaying = true;
          }
          updateDisplay();
        }

        window.playPause = playPause;
        window.nextExtraction = nextExtraction;
        window.prevExtraction = prevExtraction;
        window.jumpToExtraction = jumpToExtraction;

        updateDisplay();
      })();
    </script>